<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.mycompany.miniproject.dao.ReviewDao">
	<select id="selectReviewList" parameterType="int" resultType="Review">
		select review_id, review_score, review_content, review_image_data,
			review_image_name, review_image_type, 
			created_at, user_id
		from review
		where product_id = #{productId} and review_enable=1
	</select>
	
	<select id="selectReview" parameterType="int" resultType="Review">
		select review_image_data, review_image_name, review_image_type
		from review
		where review_id = #{reviewId}
	</select>
	
	<insert id="insertReview" parameterType="map">
		<selectKey keyProperty="reviewId" resultType="int" order="BEFORE" >
			select reviews_seq.nextval from dual
		</selectKey>
		insert into review (
			review_id, created_at, product_id, user_id, review_enable
		) values (
			#{reviewId}, #{createdAt}, #{productId}, #{userId}, 0
		)
	</insert>
</mapper>